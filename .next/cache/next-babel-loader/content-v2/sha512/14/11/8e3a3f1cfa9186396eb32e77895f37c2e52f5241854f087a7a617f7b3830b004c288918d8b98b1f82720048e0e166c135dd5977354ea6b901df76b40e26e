{"ast":null,"code":"import _toConsumableArray from \"/Users/eyasu/Desktop/leanbits/Heineken-SalesTraining-Dashboard/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport axios from \"axios\";\nimport URLst, { handle401 } from \"../../utils/constants\";\nimport * as actionTypes from \"./moduleActionTypes\";\nimport { AddModuleToCourse } from \"../Courses/courseAction\";\nexport var allmodulePending = function allmodulePending() {\n  return {\n    type: actionTypes.MODULE_PENDING,\n    isPending: true\n  };\n};\nexport var allmoduleSuccess = function allmoduleSuccess(data) {\n  return {\n    type: actionTypes.MODULE_SUCCESS,\n    isPending: false,\n    data: data.results,\n    count: data.totalResults\n  };\n};\nexport var moduleCreateSuccess = function moduleCreateSuccess(data) {\n  return {\n    type: actionTypes.CREATE_MODULE_SUCCESS,\n    data: data\n  };\n};\nexport var updateModuleSuccess = function updateModuleSuccess(data) {\n  return {\n    type: actionTypes.UPDATE_MODULE_SUCCESS,\n    isPending: false,\n    data: data\n  };\n};\nexport var deleteModuleSuccess = function deleteModuleSuccess(data) {\n  return {\n    type: actionTypes.DELETE_MODULE_SUCCESS,\n    isPending: false,\n    data: data\n  };\n};\nexport var allmoduleFail = function allmoduleFail(error) {\n  return {\n    type: actionTypes.MODULE_FAILED,\n    error: error,\n    isPending: false\n  };\n};\nexport var getAllModuleSuccess = function getAllModuleSuccess(limit, page) {\n  var token = localStorage.getItem(\"token\");\n  return function (dispatch) {\n    dispatch(allmodulePending());\n    axios({\n      method: \"get\",\n      url: URLst + \"v1/modules?limit=\".concat(limit, \"&page=\").concat(page),\n      headers: {\n        Authorization: \"Bearer \".concat(token)\n      }\n    }).then(function (res) {\n      console.log(res.data);\n      dispatch(allmoduleSuccess(res.data));\n    })[\"catch\"](function (err) {\n      var errorData;\n\n      if (err.response.data.code == 401) {\n        handle401();\n      }\n\n      if (err.response != null) {\n        errorData = err.response.data.message;\n      } else {\n        errorData = err.message;\n      }\n\n      console.log(errorData);\n      dispatch(allmoduleFail(errorData));\n    });\n  };\n};\nexport var moduleCreate = function moduleCreate(courseid, formData, modules) {\n  return function (dispatch) {\n    dispatch(allmodulePending());\n    var token = localStorage.getItem(\"token\");\n    axios.post(URLst + \"v1/modules\", {\n      title: formData.title,\n      summary: formData.summary\n    }, {\n      headers: {\n        Authorization: \"Bearer \".concat(token)\n      }\n    }).then(function (res) {\n      console.log(res.data);\n      var result = AddModuleToCourse(courseid, res.data.id, modules);\n      console.log(result);\n      dispatch(moduleCreateSuccess(res.data));\n    })[\"catch\"](function (err) {\n      if (err.response.data.code == 401) {\n        handle401();\n      }\n\n      var errorData;\n\n      if (err.response != null) {\n        errorData = err.response.data.message;\n      } else {\n        errorData = err.message;\n      }\n\n      console.log(errorData);\n      dispatch(allmoduleFail(errorData));\n    });\n  };\n};\nexport var AllModuleEdit = function AllModuleEdit(id, modules, edited) {\n  var token = localStorage.getItem(\"token\");\n  return function (dispatch, getState) {\n    dispatch(allmodulePending());\n    axios({\n      method: \"patch\",\n      url: URLst + \"v1/modules/\".concat(id),\n      headers: {\n        Authorization: \"Bearer \".concat(token)\n      },\n      data: edited\n    }).then(function (res) {\n      var newData = _toConsumableArray(modules);\n\n      var index = newData.findIndex(function (av) {\n        return av.id === res.data.id;\n      });\n      newData[index] = res.data;\n      dispatch(updateModuleSuccess(newData));\n    })[\"catch\"](function (err) {\n      var errorData;\n\n      if (err.response.data.code == 401) {\n        handle401();\n      }\n\n      if (err.response != null) {\n        errorData = err.response.data.message;\n      } else {\n        errorData = err.message;\n      }\n\n      console.log(errorData);\n      dispatch(allmoduleFail(errorData));\n    });\n  };\n};\nexport var AllModuleDelete = function AllModuleDelete(id, modules) {\n  var filtereddata = modules.filter(function (item) {\n    return item.id !== id;\n  });\n  var token = localStorage.getItem(\"token\");\n  return function (dispatch) {\n    dispatch(allmodulePending());\n    axios({\n      method: \"delete\",\n      url: URLst + \"v1/modules/\".concat(id),\n      headers: {\n        Authorization: \"Bearer \".concat(token)\n      }\n    }).then(function (res) {\n      dispatch(deleteModuleSuccess(filtereddata));\n    })[\"catch\"](function (err) {\n      var errorData;\n\n      if (err.response.data.code == 401) {\n        handle401();\n      }\n\n      if (err.response != null) {\n        errorData = err.response.data.message;\n      } else {\n        errorData = err.message;\n      }\n\n      dispatch(allmoduleFail(errorData));\n    });\n  };\n};","map":null,"metadata":{},"sourceType":"module"}